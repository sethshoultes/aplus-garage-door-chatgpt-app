import{R as x,j as e,a as u,r as i,P as n}from"./app-DS5tdZfu.js";import{C as p,a as f}from"./circle-check-y6VwcHnf.js";import{T as w}from"./triangle-alert-BxZzasPG.js";function h(){const[t,c]=i.useState(null),[g,o]=i.useState(!0),[l,a]=i.useState(null);if(i.useEffect(()=>{async function d(){try{if(console.log("[Widget] Checking for window.openai..."),console.log("[Widget] window.openai exists:",!!window.openai),console.log("[Widget] window.openai keys:",window.openai?Object.keys(window.openai):"N/A"),console.log("[Widget] window.openai object:",window.openai),!window.openai){console.error("[Widget] window.openai is not available"),a("OpenAI bridge not available"),o(!1);return}console.log("[Widget] getToolOutput type:",typeof window.openai.getToolOutput);let s;if(window.openai.toolOutput)console.log("[Widget] Using toolOutput property"),s=window.openai.toolOutput,console.log("[Widget] toolOutput value:",JSON.stringify(s,null,2));else if(window.__TOOL_OUTPUT__)console.log("[Widget] Using __TOOL_OUTPUT__"),s=window.__TOOL_OUTPUT__,console.log("[Widget] __TOOL_OUTPUT__ value:",JSON.stringify(s,null,2));else{console.error("[Widget] No way to get tool output"),a("toolOutput not found. Available: "+Object.keys(window.openai).join(", ")),o(!1);return}console.log("[Widget] Final output to render:",JSON.stringify(s,null,2)),console.log("[Widget] is_covered =",s==null?void 0:s.is_covered),console.log("[Widget] service_area_name =",s==null?void 0:s.service_area_name),c(s)}catch(s){console.error("[Widget] Failed to fetch tool output:",s),a(s instanceof Error?s.message:String(s))}finally{o(!1)}}if(typeof window.openai<"u")d();else{console.log("[Widget] Waiting for bridge...");const s=setInterval(()=>{typeof window.openai<"u"&&(console.log("[Widget] Bridge ready!"),clearInterval(s),d())},100);setTimeout(()=>{clearInterval(s),window.openai||(console.error("[Widget] Bridge timeout - window.openai never became available"),a("Timeout waiting for OpenAI bridge"),o(!1))},5e3)}},[]),g)return e.jsx("div",{className:"w-full max-w-md mx-auto p-4",children:e.jsxs("div",{className:"animate-pulse space-y-3",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/4"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/2"})]})});if(!t)return e.jsxs("div",{className:"w-full max-w-md mx-auto p-4 space-y-2",children:[e.jsx("p",{className:"text-gray-900 font-semibold",children:"Unable to load service area information"}),l&&e.jsx("div",{className:"p-3 bg-red-50 border border-red-200 rounded",children:e.jsx("p",{className:"text-sm text-red-900 font-mono",children:l})}),e.jsx("p",{className:"text-xs text-gray-500",children:"Check browser console for details"})]});const r=()=>{t.phone&&window.openai.openUrl(`tel:${t.phone.replace(/[^0-9]/g,"")}`)},m=()=>{window.openai.sendMessage("I'd like to book an appointment")};return t.is_covered?e.jsxs("div",{className:"p-6 w-full max-w-md mx-auto space-y-4 rounded-2xl border border-gray-200 bg-white shadow-lg",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"mt-0.5",children:e.jsx(p,{className:"size-5 text-green-600"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["We service ",t.service_area_name,"!"]}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:t.state}),e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:"24/7 Emergency"})]})]})]}),e.jsx("div",{className:"rounded-lg bg-gray-50 p-4 border border-gray-200",children:e.jsxs("p",{className:"text-sm text-gray-700",children:["A Plus Garage Doors has been serving ",t.service_area_name," with same-day service and expert technicians. Our team is ready to help you today!"]})}),e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg bg-blue-50 border border-blue-200",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-blue-900 uppercase tracking-wide",children:"Direct Line"}),e.jsx("p",{className:"text-lg font-semibold text-blue-900",children:t.phone})]}),e.jsx(n,{className:"size-6 text-blue-600"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:r,className:"flex-1 inline-flex items-center justify-center gap-2 px-4 py-2.5 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-lg transition-colors",children:[e.jsx(n,{className:"size-4"}),"Call Now"]}),e.jsxs("button",{onClick:m,className:"flex-1 inline-flex items-center justify-center gap-2 px-4 py-2.5 bg-gray-100 hover:bg-gray-200 text-gray-900 font-medium rounded-lg transition-colors",children:[e.jsx(f,{className:"size-4"}),"Book Online"]})]})]}):e.jsxs("div",{className:"p-6 w-full max-w-md mx-auto space-y-4 rounded-2xl border border-gray-200 bg-white shadow-lg",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"mt-0.5",children:e.jsx(w,{className:"size-5 text-amber-600"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Outside service area"}),e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["Nearest coverage: ",e.jsx("span",{className:"font-medium",children:t.nearest_coverage})]})]})]}),e.jsx("div",{className:"rounded-lg bg-amber-50 p-4 border border-amber-200",children:e.jsx("p",{className:"text-sm text-amber-900",children:"Call us to discuss optionsâ€”we may still be able to help with your garage door needs!"})}),t.phone&&e.jsxs("button",{onClick:r,className:"w-full inline-flex items-center justify-center gap-2 px-4 py-2.5 bg-gray-800 hover:bg-gray-900 text-white font-medium rounded-lg transition-colors",children:[e.jsx(n,{className:"size-4"}),"Call ",t.phone]})]})}x.createRoot(document.getElementById("root")).render(e.jsx(u.StrictMode,{children:e.jsx(h,{})}));
