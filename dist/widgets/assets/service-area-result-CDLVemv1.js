import{R as u,j as e,a as h,r as t,B as g,P as r,b as l}from"./app-C7A3LKTd.js";import{C as w,a as f}from"./circle-check-sKmjRnQX.js";import{T as b}from"./triangle-alert-DrxyNifV.js";function j(){const[o,m]=t.useState(null),[x,a]=t.useState(!0),[n,i]=t.useState(null);if(t.useEffect(()=>{async function c(){try{if(console.log("[Widget] Checking for window.openai..."),console.log("[Widget] window.openai exists:",!!window.openai),console.log("[Widget] window.openai keys:",window.openai?Object.keys(window.openai):"N/A"),console.log("[Widget] window.openai object:",window.openai),!window.openai){console.error("[Widget] window.openai is not available"),i("OpenAI bridge not available"),a(!1);return}console.log("[Widget] getToolOutput type:",typeof window.openai.getToolOutput);let s;if(window.openai.toolOutput)console.log("[Widget] Using toolOutput property"),s=window.openai.toolOutput,console.log("[Widget] toolOutput value:",JSON.stringify(s,null,2));else if(window.__TOOL_OUTPUT__)console.log("[Widget] Using __TOOL_OUTPUT__"),s=window.__TOOL_OUTPUT__,console.log("[Widget] __TOOL_OUTPUT__ value:",JSON.stringify(s,null,2));else{console.error("[Widget] No way to get tool output"),i("toolOutput not found. Available: "+Object.keys(window.openai).join(", ")),a(!1);return}console.log("[Widget] Final output to render:",JSON.stringify(s,null,2)),console.log("[Widget] is_covered =",s==null?void 0:s.is_covered),console.log("[Widget] service_area_name =",s==null?void 0:s.service_area_name),m(s)}catch(s){console.error("[Widget] Failed to fetch tool output:",s),i(s instanceof Error?s.message:String(s))}finally{a(!1)}}if(typeof window.openai<"u")c();else{console.log("[Widget] Waiting for bridge...");const s=setInterval(()=>{typeof window.openai<"u"&&(console.log("[Widget] Bridge ready!"),clearInterval(s),c())},100);setTimeout(()=>{clearInterval(s),window.openai||(console.error("[Widget] Bridge timeout - window.openai never became available"),i("Timeout waiting for OpenAI bridge"),a(!1))},5e3)}},[]),x)return e.jsx("div",{className:"p-4 max-w-md",children:e.jsxs("div",{className:"animate-pulse space-y-3",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/4"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/2"})]})});if(!o)return e.jsxs("div",{className:"p-4 max-w-md space-y-2",children:[e.jsx("p",{className:"text-gray-900 font-semibold",children:"Unable to load service area information"}),n&&e.jsx("div",{className:"p-3 bg-red-50 border border-red-200 rounded",children:e.jsx("p",{className:"text-sm text-red-900 font-mono",children:n})}),e.jsx("p",{className:"text-xs text-gray-500",children:"Check browser console for details"})]});const d=()=>{o.phone&&window.openai.openUrl(`tel:${o.phone.replace(/[^0-9]/g,"")}`)},p=()=>{window.openai.sendMessage("I'd like to book an appointment")};return o.is_covered?e.jsxs("div",{className:"p-6 max-w-md space-y-4 rounded-2xl border bg-surface shadow-lg",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"mt-0.5",children:e.jsx(w,{className:"size-5 text-green-600"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["We service ",o.service_area_name,"!"]}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx(g,{color:"success",children:o.state}),e.jsx(g,{color:"primary",children:"24/7 Emergency"})]})]})]}),e.jsx("div",{className:"rounded-lg bg-gray-50 p-4 border border-gray-200",children:e.jsxs("p",{className:"text-sm text-gray-700",children:["A Plus Garage Doors has been serving ",o.service_area_name," with same-day service and expert technicians. Our team is ready to help you today!"]})}),e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg bg-blue-50 border border-blue-200",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-blue-900 uppercase tracking-wide",children:"Direct Line"}),e.jsx("p",{className:"text-lg font-semibold text-blue-900",children:o.phone})]}),e.jsx(r,{className:"size-6 text-blue-600"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(l,{onClick:d,variant:"solid",color:"primary",block:!0,children:[e.jsx(r,{className:"size-4"}),"Call Now"]}),e.jsxs(l,{onClick:p,variant:"soft",color:"secondary",block:!0,children:[e.jsx(f,{className:"size-4"}),"Book Online"]})]})]}):e.jsxs("div",{className:"p-6 max-w-md space-y-4 rounded-2xl border bg-surface shadow-lg",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"mt-0.5",children:e.jsx(b,{className:"size-5 text-amber-600"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Outside service area"}),e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["Nearest coverage: ",e.jsx("span",{className:"font-medium",children:o.nearest_coverage})]})]})]}),e.jsx("div",{className:"rounded-lg bg-amber-50 p-4 border border-amber-200",children:e.jsx("p",{className:"text-sm text-amber-900",children:"Call us to discuss optionsâ€”we may still be able to help with your garage door needs!"})}),o.phone&&e.jsxs(l,{onClick:d,variant:"solid",color:"secondary",block:!0,children:[e.jsx(r,{className:"size-4"}),"Call ",o.phone]})]})}u.createRoot(document.getElementById("root")).render(e.jsx(h.StrictMode,{children:e.jsx(j,{})}));
